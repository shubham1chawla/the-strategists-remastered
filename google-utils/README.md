# The Strategists - Google Utilities

This directory contains all the source files required to run the Google API-based utilities. These Utilities include -
1. Exporting Google Sheets-based Permissions
2. Downloading game data available on Google Drive
3. Uploading new data generated by the game on Google Drive

## Setup
- Make sure you have `poetry` installed on your system. If not, use `pip install poetry` command.
- (Optional) Configure `poetry` to create virtual environments inside project directory by executing `poetry config virtualenvs.in-project true` command.
- Install dependencies by executing `poetry install` command.
- To enter the virtual environment, use `poetry shell` command.

## Commands
- Use the following sample command to export `permissions.json` from Google Sheets.

        ./main.py permissions \
        --credentials-json <PATH TO SERVICE ACCOUNT'S CREDENTIALS FILE> \
        --spreadsheet-id <GOOGLE SHEETS' SHEET ID> \
        --spreadsheet-range <SPREADSHEET RANGE> \
        --export-dir <PATH TO EXPORT DIRECTORY>

- Use the following sample command to download game data from Google Drive.

        ./main.py predictions download \
        --credentials-json <PATH TO SERVICE ACCOUNT'S CREDENTIALS FILE> \
        --download-folder-id <GOOGLE DRIVE DOWNLOAD FOLDER ID> \
        --game-data-dir <PATH TO DATA DIRECTORY> \
        --strategy {missing,overwrite}

- Use the following sample command to upload game data to Google Drive.

        ./main.py predictions upload \
        --credentials-json <PATH TO SERVICE ACCOUNT'S CREDENTIALS FILE> \
        --download-folder-id <GOOGLE DRIVE DOWNLOAD FOLDER ID> \
        --upload-folder-id <GOOGLE DRIVE UPLOAD FOLDER ID> \
        --game-data-dir <PATH TO DATA DIRECTORY>

## Note
- To export permissions, the service account's email should have at least _Viewer_ permission on the Google Sheets' sheet.
- To download game data, the service account's email should have at least _Viewer_ permission on the Google Drive's download folder.
- To upload game data, the service account's email should have at least _Editor_ permission on the Google Drive's upload folder.
- By default, the download strategy is set to _missing_, which means that the utility will only download missing CSV files. If you wish to overwrite already downloaded files, use `--strategy overwrite` flag.
- The script will only upload files that are not in either download or upload folders.

## Reference
- [Google Drive API Python Client Documentation](https://developers.google.com/drive/api/guides/about-sdk)
- [Google Sheets API Python Quickstart](https://developers.google.com/sheets/api/quickstart/python)
